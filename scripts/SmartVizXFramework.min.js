"use strict";if(void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.HttpFileLoader=function(e,t,r,a,n){var i=e,o=a,l=t,m=r,u=n,c={REQUEST_NOT_INITIALIZED:0,SERVER_CONNECTION_ESTABLISHED:1,REQUEST_RECEIVED:2,PROCESSING_REQUEST:3,REQUEST_FINISHED_AND_RESPONSE_IS_READY:4,OK:200,PAGE_NOT_FOUND:404},d=this;!function(){e=void 0,a=void 0,t=void 0,r=void 0,n=void 0}(),d.loadFile=function(){if((void 0==d.request||null==d.request)&&document.implementation&&document.implementation.createDocument){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===c.REQUEST_FINISHED_AND_RESPONSE_IS_READY)e.status!==c.REQUEST_NOT_INITIALIZED&&e.status!==c.OK||(e.response?o==SmartVizXFramework.HttpFileLoader.FileType.XML?e.responseXML?(l(e.responseXML,u),d.destroy()):(m("HttpFileLoader: Invalid XML ("+i+")",u),d.destroy()):(l(e.response,u),d.destroy()):(m("HttpFileLoader: Empty or non-existing file ("+i+")",u),d.destroy()));else if(e.readyState===c.PROCESSING_REQUEST);else if(e.readyState===c.PAGE_NOT_FOUND){var t=i;t&&m("HttpFileLoader: Non-existing file ("+t+")",u),d.destroy()}if(e.status===c.PAGE_NOT_FOUND){var t=i;t&&m("HttpFileLoader: Empty or non-existing file ("+t+")",u),d.destroy()}},e.addEventListener("error",function(e){m("HttpFileLoader: Empty or non-existing file ("+i+")",u),d.destroy()}),e.open("GET",i,!0),o==SmartVizXFramework.HttpFileLoader.FileType.BINARY?e.responseType="arraybuffer":o==SmartVizXFramework.HttpFileLoader.FileType.XML&&e.overrideMimeType("text/xml"),e.send(null)}else m("Don't know how to parse XML!",u)},d.destroy=function(){i=null,o=null,l=null,m=null,u=null}},SmartVizXFramework.HttpFileLoader.FileType={BINARY:0,XML:1},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Settings={},SmartVizXFramework.Settings.requiredAspect=700/1920,SmartVizXFramework.Settings.maxWidth=1920,void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.InputHandler=function(e){function t(e){87==e.keyCode&&(u|=o.Forward),83==e.keyCode&&(u|=o.Backward),65==e.keyCode&&(u|=o.Left),68==e.keyCode&&(u|=o.Right),37==e.keyCode&&(u|=o.LookLeft),39==e.keyCode&&(u|=o.LookRight),38==e.keyCode&&(u|=o.LookUp),40==e.keyCode&&(u|=o.LookDown),33==e.keyCode&&(u|=o.MoveUp),34==e.keyCode&&(u|=o.MoveDown)}function r(e){87==e.keyCode&&(u^=o.Forward),83==e.keyCode&&(u^=o.Backward),65==e.keyCode&&(u^=o.Left),68==e.keyCode&&(u^=o.Right),37==e.keyCode&&(u^=o.LookLeft),39==e.keyCode&&(u^=o.LookRight),38==e.keyCode&&(u^=o.LookUp),40==e.keyCode&&(u^=o.LookDown),33==e.keyCode&&(u^=o.MoveUp),34==e.keyCode&&(u^=o.MoveDown)}function a(e){if(window.DeviceMotionEvent){var t=window.orientation,r={Acceleration:{x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},AngleAcceleration:{alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma},AccelerationIncludingGravity:{x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},Orientation:t};i("onAccelerometer",r)}}function n(e){if(window.DeviceOrientationEvent){var t=window.orientation,r={Angles:{alpha:e.alpha,beta:e.beta,gamma:e.gamma},Orientation:t};i("onDeviceOrientation",r)}}function i(e,t){var r=m[e];if(r){null!=t&&void 0!=t||(t={});for(var a=r.length,n=0;n<a;n++)t.callBackID=r[n].callBackID,r[n].callbackFun(t)}}var o={Forward:1,Backward:2,Right:4,Left:8,LookUp:16,LookDown:32,LookLeft:64,LookRight:128,MoveUp:256,MoveDown:512},l=void 0!==e?e:document,m={},u=0,c=this;!function(){window.addEventListener("keydown",t,!1),window.addEventListener("keyup",r,!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",a,!1),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",n,!1),e=null,u=0}(),c.InputHandler_destroyInternal=function(){window.removeEventListener("keydown",t,!1),window.removeEventListener("keyup",r,!1),window.DeviceMotionEvent&&window.removeEventListener("devicemotion",a,!1),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",n,!1),c=null,l=null,m={},u=0},c.InputHandler_updateInternal=function(e){u&o.Forward&&i("onMoveForward"),u&o.Backward&&i("onMoveBackward"),u&o.Left&&i("onMoveLeft"),u&o.Right&&i("onMoveRight"),u&o.LookUp&&i("onLookUp"),u&o.LookDown&&i("onLookDown"),u&o.LookLeft&&i("onLookLeft"),u&o.LookRight&&i("onLookRight"),u&o.MoveUp&&i("onMoveUp"),u&o.MoveDown&&i("onMoveDown")},c.InputHandler_addOnEventInternal=function(e,t,r){void 0!=e&&null!=e&&""!=e&&void 0!=t&&null!=t&&(void 0!=m[e]&&null!=m[e]||(m[e]=[]),m[e].push({callbackFun:t,callBackID:r}))},c.InputHandler_removeOnEventInternal=function(e){null!=e&&void 0!=e||console.error("Unable to remove callback function");for(var t in m){for(var r=m[t],a=r.length,n=[],i=0;i<a;i++){var o=r[i];o.callbackFun==e&&n.push(i)}a=n.length;for(var i=0;i<a;i++)r.splice(n[i],1)}}},SmartVizXFramework.InputHandler.prototype.update=function(e){this.InputHandler_updateInternal(e)},SmartVizXFramework.InputHandler.prototype.destroy=function(){this.InputHandler_destroyInternal()},SmartVizXFramework.InputHandler.prototype.addOnEvent=function(e,t,r){this.InputHandler_addOnEventInternal(e,t,r)},SmartVizXFramework.InputHandler.prototype.removeOnEvent=function(e){this.InputHandler_removeOnEventInternal(e)},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Math={},SmartVizXFramework.Math.EPSILON=1e-6,SmartVizXFramework.Math.Sign=function(e){return e>=0?1:-1},SmartVizXFramework.Math.Abs=function(e){return SmartVizXFramework.Math.Sign(e)*e},SmartVizXFramework.Math.Clamp=function(e,t,r){return e<t?t:e>r?r:e},SmartVizXFramework.Math.MinVec3=function(e,t){return new SmartVizXFramework.Vector3(Math.min(e.getX(),t.getX()),Math.min(e.getY(),t.getY()),Math.min(e.getZ(),t.getZ()))},SmartVizXFramework.Math.MaxVec3=function(e,t){var r=e.getX(),a=t.getX();Math.max(r,a);return new SmartVizXFramework.Vector3(Math.max(e.getX(),t.getX()),Math.max(e.getY(),t.getY()),Math.max(e.getZ(),t.getZ()))},SmartVizXFramework.Math.DegToRad=.0174533,SmartVizXFramework.Math.RadToDeg=57.2958,void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Vector3=function(e,t,r){var a=e?e:0,n=t?t:0,i=r?r:0,o=this;o.set=function(e,t,r){a=e,n=t,i=r},o.setX=function(e){a=e},o.setY=function(e){n=e},o.setZ=function(e){i=e},o.getX=function(){return a},o.getY=function(){return n},o.getZ=function(){return i},o.copy=function(e){a=e.getX(),n=e.getY(),i=e.getZ()},o.getCopy=function(){var e=new SmartVizXFramework.Vector3(a,n,i);return e},o.multiplyScaler=function(e){a*=e,n*=e,i*=e},o.getMultiplyScaler=function(e){var t=new SmartVizXFramework.Vector3(a,n,i);return t.multiplyScaler(e),t},o.dot=function(e){return a*e.getX()+n*e.getY()+i*e.getZ()},o.cross=function(e){var t=o.getX(),r=o.getY(),l=o.getZ();a=r*e.getZ()-l*e.getY(),n=l*e.getX()-t*e.getZ(),i=t*e.getY()-r*e.getX()},o.getCross=function(e){var t=o.getX(),r=o.getY(),a=o.getZ(),n=r*e.getZ()-a*e.getY(),i=a*e.getX()-t*e.getZ(),l=t*e.getY()-r*e.getX();return new SmartVizXFramework.Vector3(n,i,l)},o.add=function(e){a+=e.getX(),n+=e.getY(),i+=e.getZ()},o.addComponent=function(e,t,r){a=a+e?e:0,n=n+t?t:0,i=i+r?r:0},o.subtract=function(e){a-=e.getX(),n-=e.getY(),i-=e.getZ()},o.subtractComponent=function(e,t,r){a=a-e?e:0,n=n-t?t:0,i=i-r?r:0},o.sqrMagnitude=function(){return a*a+n*n+i*i},o.magnitude=function(){return Math.sqrt(o.sqrMagnitude())},o.normalize=function(){var e=o.magnitude();e>SmartVizXFramework.Math.EPSILON?o.multiplyScaler(1/e):console.error("Can not normalize Vector3")},o.slerp=function(e,t){var r=new SmartVizXFramework.Vector3(a,n,i),o=new SmartVizXFramework.Vector3(e.getX(),e.getY(),e.getZ()),l=r.dot(o);l=SmartVizXFramework.Math.Clamp(l,-1,1);var m=Math.acos(l)*t,u=new SmartVizXFramework.Vector3(r.getX(),r.getY(),r.getZ());u.multiplyScaler(l),o.subtract(u),o.normalize(),r.multiplyScaler(Math.cos(m)),o.multiplyScaler(Math.sin(m)),a=r.getX()+o.getX(),a=r.getY()+o.getY(),a=r.getZ()+o.getZ()}},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.AABB=function(e,t){var r=new SmartVizXFramework.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new SmartVizXFramework.Vector3((-Number.MAX_VALUE),(-Number.MAX_VALUE),(-Number.MAX_VALUE));!function(){e&&e instanceof SmartVizXFramework.Vector3&&r.copy(e),t&&t instanceof SmartVizXFramework.Vector3&&a.copy(t),e=void 0,t=void 0}();var n=this;n.getCenter=function(){var e=a.getCopy();return e.add(r),e.multiplyScaler(.5),e},n.addPoint=function(e){e instanceof SmartVizXFramework.Vector3&&(r=SmartVizXFramework.Math.MinVec3(r,e),a=SmartVizXFramework.Math.MaxVec3(a,e))},n.union=function(e){e instanceof SmartVizXFramework.AABB&&(n.addPoint(e.getMin()),n.addPoint(e.getMax()))},n.getMin=function(){return r.getCopy()},n.getMax=function(){return a.getCopy()}},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.WebGLContext=function(e){var t=null,r=e,a=null,n=this;!function(){t=document.createElement("canvas");var n=e.clientWidth,i=e.clientHeight;n>SmartVizXFramework.Settings.maxWidth&&(n=SmartVizXFramework.Settings.maxWidth,i=n*SmartVizXFramework.Settings.requiredAspect),t.id="SmartVizXFrameworkCanvas",t.width=n,t.height=i,t.style.width="100%",t.style.height="100%",r.appendChild(t),a=t.getContext("webgl",{antialias:!0,stencil:!1}),e=void 0}(),n.WebGLContext_getCanvasInternal=function(){return t},n.WebGLContext_getGLContextInternal=function(){return a},n.WebGLContext_resizeInternal=function(e,r){e>SmartVizXFramework.Settings.maxWidth&&(e=SmartVizXFramework.Settings.maxWidth,r=e*SmartVizXFramework.Settings.requiredAspect),t.width=e,t.height=r,t.style.width="100%",t.style.height="100%"},n.WebGLContext_getWidthInternal=function(){return t.width},n.WebGLContext_getHeightInternal=function(){return t.height},n.WebGLContext_destroyInternal=function(){null!=t&&(t.remove(),t=null),r=null,a=null,n=null}},SmartVizXFramework.WebGLContext.prototype.getCanvas=function(){return this.WebGLContext_getCanvasInternal()},SmartVizXFramework.WebGLContext.prototype.getGLContext=function(){return this.WebGLContext_getGLContextInternal()},SmartVizXFramework.WebGLContext.prototype.resize=function(e,t){return this.WebGLContext_resizeInternal(e,t)},SmartVizXFramework.WebGLContext.prototype.getWidth=function(){return this.WebGLContext_getWidthInternal()},SmartVizXFramework.WebGLContext.prototype.getHeight=function(){return this.WebGLContext_getHeightInternal()},SmartVizXFramework.WebGLContext.prototype.destroy=function(){return this.WebGLContext_destroyInternal()},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Matrix4=function(e){function t(e){if(e&&e.length&&16==e.length){for(var t=e.length,r=0;r<t;r++)if(!SmartVizXFramework.Utils.isValidNum(e[r]))return!1;return!0}return!1}function r(e){for(var t=e.length,r=0;r<t;r++)a[r]=e[r]}var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n=this;!function(){e&&e.length&&16==e.length&&t(e)&&r(e),e=void 0}(),n.setElement=function(e,t){a[e]=t},n.getElement=function(e){return a[e]},n.getElements=function(){return a},n.copy=function(e){e instanceof SmartVizXFramework.Matrix4&&r(e.getElements())},n.setTranslate=function(e){a[12]=e.getX(),a[13]=e.getY(),a[14]=e.getZ()},n.translate=function(e){a[12]+=e.getX(),a[13]+=e.getY(),a[14]+=e.getZ()},n.getTranslate=function(){return new SmartVizXFramework.Vector3(a[12],a[13],a[14])},n.getRight=function(){return new SmartVizXFramework.Vector3(a[0],a[1],a[2])},n.getUp=function(){return new SmartVizXFramework.Vector3(a[4],a[5],a[6])},n.getForward=function(){return new SmartVizXFramework.Vector3(a[8],a[9],a[10])},n.setRotationX=function(e){var t=Math.cos(e),r=Math.sin(e);a[0]=1,a[1]=0,a[2]=0,a[4]=0,a[5]=t,a[6]=-r,a[8]=0,a[9]=r,a[10]=t},n.setRotationY=function(e){var t=Math.cos(e),r=Math.sin(e);a[0]=t,a[1]=0,a[2]=r,a[4]=0,a[5]=1,a[6]=0,a[8]=-r,a[9]=0,a[10]=t},n.setRotationZ=function(e){var t=Math.cos(e),r=Math.sin(e);a[0]=t,a[1]=-r,a[2]=0,a[4]=r,a[5]=t,a[6]=0,a[8]=0,a[9]=0,a[10]=1},n.setRotationXCosSine=function(e,t){a[0]=1,a[1]=0,a[2]=0,a[4]=0,a[5]=e,a[6]=-t,a[8]=0,a[9]=t,a[10]=e},n.setRotationYCosSine=function(e,t){a[0]=e,a[1]=0,a[2]=t,a[4]=0,a[5]=1,a[6]=0,a[8]=-t,a[9]=0,a[10]=e},n.setRotationZCosSine=function(e,t){a[0]=e,a[1]=-t,a[2]=0,a[4]=t,a[5]=e,a[6]=0,a[8]=0,a[9]=0,a[10]=1},n.postMultiply=function(e){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n=a,i=e.getElements(),o=n[0],l=n[4],m=n[8],u=n[12],c=n[1],d=n[5],s=n[9],f=n[13],g=n[2],v=n[6],h=n[10],w=n[14],S=n[3],F=n[7],V=n[11],X=n[15],k=i[0],p=i[4],z=i[8],M=i[12],E=i[1],y=i[5],I=i[9],L=i[13],A=i[2],R=i[6],C=i[10],D=i[14],_=i[3],T=i[7],x=i[11],N=i[15];t[0]=o*k+l*E+m*A+u*_,t[4]=o*p+l*y+m*R+u*T,t[8]=o*z+l*I+m*C+u*x,t[12]=o*M+l*L+m*D+u*N,t[1]=c*k+d*E+s*A+f*_,t[5]=c*p+d*y+s*R+f*T,t[9]=c*z+d*I+s*C+f*x,t[13]=c*M+d*L+s*D+f*N,t[2]=g*k+v*E+h*A+w*_,t[6]=g*p+v*y+h*R+w*T,t[10]=g*z+v*I+h*C+w*x,t[14]=g*M+v*L+h*D+w*N,t[3]=S*k+F*E+V*A+X*_,t[7]=S*p+F*y+V*R+X*T,t[11]=S*z+F*I+V*C+X*x,t[15]=S*M+F*L+V*D+X*N,r(t)},n.preMultiply=function(e){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n=e.getElements(),i=a,o=n[0],l=n[4],m=n[8],u=n[12],c=n[1],d=n[5],s=n[9],f=n[13],g=n[2],v=n[6],h=n[10],w=n[14],S=n[3],F=n[7],V=n[11],X=n[15],k=i[0],p=i[4],z=i[8],M=i[12],E=i[1],y=i[5],I=i[9],L=i[13],A=i[2],R=i[6],C=i[10],D=i[14],_=i[3],T=i[7],x=i[11],N=i[15];t[0]=o*k+l*E+m*A+u*_,t[4]=o*p+l*y+m*R+u*T,t[8]=o*z+l*I+m*C+u*x,t[12]=o*M+l*L+m*D+u*N,t[1]=c*k+d*E+s*A+f*_,t[5]=c*p+d*y+s*R+f*T,t[9]=c*z+d*I+s*C+f*x,t[13]=c*M+d*L+s*D+f*N,t[2]=g*k+v*E+h*A+w*_,t[6]=g*p+v*y+h*R+w*T,t[10]=g*z+v*I+h*C+w*x,t[14]=g*M+v*L+h*D+w*N,t[3]=S*k+F*E+V*A+X*_,t[7]=S*p+F*y+V*R+X*T,t[11]=S*z+F*I+V*C+X*x,t[15]=S*M+F*L+V*D+X*N,r(t)},n.multiplyScalar=function(e){a[0]*=e,a[4]*=e,a[8]*=e,a[12]*=e,a[1]*=e,a[5]*=e,a[9]*=e,a[13]*=e,a[2]*=e,a[6]*=e,a[10]*=e,a[14]*=e,a[3]*=e,a[7]*=e,a[11]*=e,a[15]*=e},n.constructProjectionMatrix=function(e,t,r,n){var i=Math.tan(.5*e);a[0]=.5/i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=.5*t/i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-(n+r)/(n-r),a[11]=-1,a[12]=0,a[13]=0,a[14]=-2*n*r/(n-r),a[15]=0},n.getInverse=function(){var e=new SmartVizXFramework.Matrix4(a);return e.inverse(),e},n.inverse=function(){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t=a[0],i=a[4],o=a[8],l=a[12],m=a[1],u=a[5],c=a[9],d=a[13],s=a[2],f=a[6],g=a[10],v=a[14],h=a[3],w=a[7],S=a[11],F=a[15];e[0]=c*v*w-d*g*w+d*f*S-u*v*S-c*f*F+u*g*F,e[4]=l*g*w-o*v*w-l*f*S+i*v*S+o*f*F-i*g*F,e[8]=o*d*w-l*c*w+l*u*S-i*d*S-o*u*F+i*c*F,e[12]=l*c*f-o*d*f-l*u*g+i*d*g+o*u*v-i*c*v,e[1]=d*g*h-c*v*h-d*s*S+m*v*S+c*s*F-m*g*F,e[5]=o*v*h-l*g*h+l*s*S-t*v*S-o*s*F+t*g*F,e[9]=l*c*h-o*d*h-l*m*S+t*d*S+o*m*F-t*c*F,e[13]=o*d*s-l*c*s+l*m*g-t*d*g-o*m*v+t*c*v,e[2]=u*v*h-d*f*h+d*s*w-m*v*w-u*s*F+m*f*F,e[6]=l*f*h-i*v*h-l*s*w+t*v*w+i*s*F-t*f*F,e[10]=i*d*h-l*u*h+l*m*w-t*d*w-i*m*F+t*u*F,e[14]=l*u*s-i*d*s-l*m*f+t*d*f+i*m*v-t*u*v,e[3]=c*f*h-u*g*h-c*s*w+m*g*w+u*s*S-m*f*S,e[7]=i*g*h-o*f*h+o*s*w-t*g*w-i*s*S+t*f*S,e[11]=o*u*h-i*c*h-o*m*w+t*c*w+i*m*S-t*u*S,e[15]=i*c*s-o*u*s+o*m*f-t*c*f-i*m*g+t*u*g;var V=t*e[0]+m*e[4]+s*e[8]+h*e[12];return SmartVizXFramework.Math.Abs(V)<=SmartVizXFramework.Math.EPSILON?void console.error("Matrix can not be inversed"):(r(e),void n.multiplyScalar(1/V))},n.angleAxis=function(e,t){var r=Math.cos(e),n=Math.sin(e),i=1-r,o=t.getX(),l=t.getY(),m=t.getZ(),u=i*o,c=i*l;a[0]=u*o+r,a[1]=u*l-n*m,a[2]=u*m+n*l,a[3]=0,a[4]=u*l+n*m,a[5]=c*l+r,a[6]=c*m-n*o,a[7]=0,a[8]=u*m-n*l,a[9]=c*m+n*o,a[10]=i*m*m+r,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},n.transpose=function(){var e,t=a;e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e},n.fromEuler=function(e,t){var r=e.getX(),n=e.getY(),i=e.getZ(),o=Math.cos(r),l=Math.sin(r),m=Math.cos(n),u=Math.sin(n),c=Math.cos(i),d=Math.sin(i);if("XYZ"===t){var s=o*c,f=o*d,g=l*c,v=l*d;a[0]=m*c,a[4]=-m*d,a[8]=u,a[1]=f+g*u,a[5]=s-v*u,a[9]=-l*m,a[2]=v-s*u,a[6]=g+f*u,a[10]=o*m}else if("YXZ"===t){var h=m*c,w=m*d,S=u*c,F=u*d;a[0]=h+F*l,a[4]=S*l-w,a[8]=o*u,a[1]=o*d,a[5]=o*c,a[9]=-l,a[2]=w*l-S,a[6]=F+h*l,a[10]=o*m}else if("ZXY"===t){var h=m*c,w=m*d,S=u*c,F=u*d;a[0]=h-F*l,a[4]=-o*d,a[8]=S+w*l,a[1]=w+S*l,a[5]=o*c,a[9]=F-h*l,a[2]=-o*u,a[6]=l,a[10]=o*m}else if("ZYX"===t){var s=o*c,f=o*d,g=l*c,v=l*d;a[0]=m*c,a[4]=g*u-f,a[8]=s*u+v,a[1]=m*d,a[5]=v*u+s,a[9]=f*u-g,a[2]=-u,a[6]=l*m,a[10]=o*m}else if("YZX"===t){var V=o*m,X=o*u,k=l*m,p=l*u;a[0]=m*c,a[4]=p-V*d,a[8]=k*d+X,a[1]=d,a[5]=o*c,a[9]=-l*c,a[2]=-u*c,a[6]=X*d+k,a[10]=V-p*d}else if("XZY"===t){var V=o*m,X=o*u,k=l*m,p=l*u;a[0]=m*c,a[4]=-d,a[8]=u*c,a[1]=V*d+p,a[5]=o*c,a[9]=X*d-k,a[2]=k*d-X,a[6]=l*c,a[10]=p*d+V}a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},n.transformVector=function(e){var t=e.getX(),r=e.getY(),n=e.getZ(),i=a,o=i[0]*t+i[4]*r+i[8]*n+i[12],l=i[1]*t+i[5]*r+i[9]*n+i[13],m=i[2]*t+i[6]*r+i[10]*n+i[14];return new SmartVizXFramework.Vector3(o,l,m)},n.rotateVector=function(e){var t=e.getX(),r=e.getY(),n=e.getZ(),i=a,o=i[0]*t+i[4]*r+i[8]*n,l=i[1]*t+i[5]*r+i[9]*n,m=i[2]*t+i[6]*r+i[10]*n;return new SmartVizXFramework.Vector3(o,l,m)}},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Utils={},SmartVizXFramework.Utils.isValidNum=function(e){return isFinite(e)&&!isNaN(e)},SmartVizXFramework.Utils.getFileNameFromPath=function(e){var t=e,r=t.split("/").pop();return r},SmartVizXFramework.Utils.getFileNameFromPathWithoutExtension=function(e){var t=SmartVizXFramework.Utils.getFileNameFromPath(e),r=t.lastIndexOf(".");return t.substr(0,r)},SmartVizXFramework.Utils.LerpDegrees=function(e,t,r){var a=Math.abs(t-e);a>180&&(t>e?e+=360:t+=360);var n=e+(t-e)*r,i=360;return n>=0&&n<=360?n:n%i},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.VertexShader="attribute vec3 Position;attribute vec3 Normal;attribute vec4 VertexColor;uniform mat4 ProjectionMatrix;uniform mat4 ViewMatrix;uniform mat4 ModelMatrix;uniform mat4 NormalMatrix;uniform vec3 LightDirection1;uniform vec3 LightDirection2;varying vec3 TransformedNormal;varying vec3 TransformedLightDir1;varying vec3 TransformedLightDir2;varying vec4 VColor;void main(void) { TransformedLightDir1 = (NormalMatrix * vec4(-LightDirection1, 1.)).xyz;TransformedLightDir2 = (NormalMatrix * vec4(-LightDirection2, 1.)).xyz;TransformedNormal = (NormalMatrix * vec4(Normal, 1.)).xyz;VColor = VertexColor;gl_Position = ProjectionMatrix * ViewMatrix * ModelMatrix * vec4(Position, 1.);}",SmartVizXFramework.FragmentShader="uniform mediump float DirectionalLight1Intensity;uniform mediump float DirectionalLight2Intensity;uniform mediump vec4 MainColor;uniform mediump vec4 AmbientLightColor;varying highp vec3 TransformedNormal;varying highp vec3 TransformedLightDir1;varying highp vec3 TransformedLightDir2;varying highp vec4 VColor;void main(void) {mediump float dotVal1 = dot(TransformedNormal, TransformedLightDir1);mediump float dotVal2 = dot(TransformedNormal, TransformedLightDir2);mediump float dotVal = min((max(0.0, dotVal1) * DirectionalLight1Intensity + max(0.0, dotVal2) * DirectionalLight2Intensity), 1.0);mediump vec4 color = vec4(VColor.rgb * MainColor.xyz * dotVal, MainColor.w * VColor.a);color = vec4(color.rgb + AmbientLightColor.rgb, color.a);color = clamp(color, 0.0, 1.0);gl_FragColor = color;}",SmartVizXFramework.ShaderAttributeTypes={Position:"Position",Normal:"Normal",VertexColor:"VertexColor"},SmartVizXFramework.ShaderUniforms={ProjectionMatrix:"ProjectionMatrix",ViewMatrix:"ViewMatrix",ModelMatrix:"ModelMatrix",NormalMatrix:"NormalMatrix",AmbientLightColor:"AmbientLightColor",LightDirection1:"LightDirection1",LightDirection2:"LightDirection2",DirectionalLight1Intensity:"DirectionalLight1Intensity",DirectionalLight2Intensity:"DirectionalLight2Intensity",MainColor:"MainColor"},SmartVizXFramework.Material=function(e){function t(e){var t=v.getGLContext(),r=t.getShaderParameter(e,t.COMPILE_STATUS);if(!r){var a=t.getShaderInfoLog(e);console.log("Shader compiler log: "+a)}}var r=null,a=null,n=null,i=null,o=null,l=null,m=null,u=null,c=null,d=null,s=null,f=null,g=null,v=e,h=[1,1,1,1],w=this;!function(){var h=v.getGLContext();a=h.createShader(h.VERTEX_SHADER),h.shaderSource(a,SmartVizXFramework.VertexShader),h.compileShader(a),t(a),r=h.createShader(h.FRAGMENT_SHADER),h.shaderSource(r,SmartVizXFramework.FragmentShader),h.compileShader(r),t(r),n=h.createProgram(),h.attachShader(n,a),h.attachShader(n,r),h.linkProgram(n),i=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.ProjectionMatrix),o=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.ViewMatrix),l=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.ModelMatrix),m=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.NormalMatrix),u=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.AmbientLightColor),c=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.LightDirection1),d=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.LightDirection2),s=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.DirectionalLight1Intensity),f=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.DirectionalLight2Intensity),g=h.getUniformLocation(n,SmartVizXFramework.ShaderUniforms.MainColor),e=null}(),w.Material_destroyInternal=function(){var e=v.getGLContext();null!=n&&(e.detachShader(n,a),e.detachShader(n,r),e.deleteProgram(n),e.deleteShader(a),e.deleteShader(r)),r=null,a=null,n=null,v=null,i=null,o=null,l=null,m=null,u=null,c=null,d=null,s=null,f=null,g=null,v=null,h=null,w=null},w.Material_beginInternal=function(e,t,r){var a=v.getGLContext();if(a.useProgram(n),a.uniformMatrix4fv(i,!1,e.getElements()),a.uniformMatrix4fv(o,!1,t.getElements()),a.uniformMatrix4fv(l,!1,r.getElements()),null!=u&&a.uniform4fv(u,SmartVizXFramework.Material.ambientLightColor),null!=c){var w=[SmartVizXFramework.Material.lightDir1.getX(),SmartVizXFramework.Material.lightDir1.getY(),SmartVizXFramework.Material.lightDir1.getZ()];a.uniform3fv(c,w)}if(null!=d){var w=[SmartVizXFramework.Material.lightDir2.getX(),SmartVizXFramework.Material.lightDir2.getY(),SmartVizXFramework.Material.lightDir2.getZ()];a.uniform3fv(d,w)}null!=s&&a.uniform1f(s,SmartVizXFramework.Material.directionalLight1Intensity),null!=f&&a.uniform1f(f,SmartVizXFramework.Material.directionalLight2Intensity),null!=g&&a.uniform4fv(g,h);var S=new SmartVizXFramework.Matrix4(r.getElements());S&&(S.preMultiply(t),S.inverse(),S.transpose(),a.uniformMatrix4fv(m,!1,S.getElements()))},w.Material_endInternal=function(){},w.Material_getShaderProgramInternal=function(){return n},w.Material_setMainColorInternal=function(e,t,r,a){h[0]=e?e:h[0],h[1]=t?e:h[1],h[2]=r?e:h[2],h[3]=a?e:h[3]}},SmartVizXFramework.Material.prototype.destroy=function(){return this.Material_destroyInternal()},SmartVizXFramework.Material.prototype.begin=function(e,t,r){return this.Material_beginInternal(e,t,r)},SmartVizXFramework.Material.prototype.end=function(){return this.Material_endInternal()},SmartVizXFramework.Material.prototype.getShaderProgram=function(){return this.Material_getShaderProgramInternal()},SmartVizXFramework.Material.prototype.setMainColor=function(e,t,r,a){return this.Material_setMainColorInternal(e,t,r,a)},SmartVizXFramework.Material.ambientLightColor=[0,0,0,1],SmartVizXFramework.Material.lightDir1=new SmartVizXFramework.Vector3(1,(-1),2),SmartVizXFramework.Material.lightDir1.normalize(),SmartVizXFramework.Material.lightDir2=new SmartVizXFramework.Vector3(2,(-1),1),SmartVizXFramework.Material.lightDir2.normalize(),SmartVizXFramework.Material.directionalLight1Intensity=1,SmartVizXFramework.Material.directionalLight2Intensity=.5,void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.Mesh=function(e,t){function r(e){if(e.length>=3&&e[0]instanceof SmartVizXFramework.Vector3){for(var t=[],r=e.length,a=0;a<r;a++)t.push(e[a].getX()),t.push(e[a].getY()),t.push(e[a].getZ());return t}if(e.length/d>=3&&SmartVizXFramework.Utils.isValidNum(e[0]))return e}function a(){if(null!=i){var e=m.getGLContext();e.deleteBuffer(i),i=null,l=0,s=null}u&&(e.deleteBuffer(u),u=null,c=0,f=null),n()}function n(){if(null!=v){var e=m.getGLContext();e.deleteBuffer(v),v=null,g=null}}var i=null,o=t,l=0,m=e,u=null,c=0,d=3,s=null,f=null,g=null,v=null,h=null,w=null,S=this;!function(){e=void 0,t=void 0}(),S.Mesh_destroyInternal=function(){a(),o=void 0,m=void 0,S=void 0,S=null},S.Mesh_setVerticesInternal=function(e){if(null!=e&&void 0!=e&&void 0!=e.length&&(a(),s=r(e))){l=s.length/d;var t=m.getGLContext();i=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null)}},S.Mesh_setIndicesInternal=function(e){if(null!=e&&void 0!=e&&void 0!=e.length&&e.length>=3&&Number.isInteger(e[0])){var t=m.getGLContext();f=e,c=e.length,u=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u);var r=new Uint16Array(e);t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},S.Mesh_prepareRenderInternal=function(e){if(null!=i&&void 0!=i){var t=m.getGLContext(),r=e.getShaderProgram();if(null!=r&&void 0!=r){t.bindBuffer(t.ARRAY_BUFFER,i);var a=t.getAttribLocation(r,SmartVizXFramework.ShaderAttributeTypes.Position);if(t.vertexAttribPointer(a,d,t.FLOAT,!1,0,0),t.enableVertexAttribArray(a),v){t.bindBuffer(t.ARRAY_BUFFER,v);var n=t.getAttribLocation(r,SmartVizXFramework.ShaderAttributeTypes.Normal);n>=0&&(t.vertexAttribPointer(n,d,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n))}if(null!=w){t.bindBuffer(t.ARRAY_BUFFER,w);var o=t.getAttribLocation(r,SmartVizXFramework.ShaderAttributeTypes.VertexColor);o>=0&&(t.vertexAttribPointer(o,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o))}t.bindBuffer(t.ARRAY_BUFFER,null)}}},S.Mesh_renderInternal=function(){if(null!=u&&void 0!=u){var e=m.getGLContext();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.drawElements(e.TRIANGLES,c,e.UNSIGNED_SHORT,0)}},S.Mesh_computeNormalsInternal=function(){if(null!=s&&void 0!=s&&null!=f&&void 0!=f){n();var e=s.length/d,t=f.length/3;g=[],g.length=s.length;for(var r=0;r<g.length;r++)g[r]=0;var a=[];a.length=e;for(var r=0;r<a.length;r++)a[r]=0;for(var r=0;r<t;r++){var i=f[3*r+0],o=f[3*r+1],l=f[3*r+2],u=new SmartVizXFramework.Vector3(s[i*d+0],s[i*d+1],s[i*d+2]),c=new SmartVizXFramework.Vector3(s[o*d+0],s[o*d+1],s[o*d+2]),h=new SmartVizXFramework.Vector3(s[l*d+0],s[l*d+1],s[l*d+2]),w=new SmartVizXFramework.Vector3(u.getX(),u.getY(),u.getZ()),S=new SmartVizXFramework.Vector3(h.getX(),h.getY(),h.getZ());w.subtract(c),S.subtract(c),w.cross(S),w.normalize(),g[i*d+0]+=-w.getX(),g[i*d+1]+=-w.getY(),g[i*d+2]+=-w.getZ(),g[o*d+0]+=-w.getX(),g[o*d+1]+=-w.getY(),g[o*d+2]+=-w.getZ(),g[l*d+0]+=-w.getX(),g[l*d+1]+=-w.getY(),g[l*d+2]+=-w.getZ(),a[i]++,a[o]++,a[l]++}for(var r=0;r<a.length;r++){var F=a[r];0==F?console.error("Share count can not be zero, some problem in the algorithm"):(g[r*d+0]/=F,g[r*d+1]/=F,g[r*d+2]/=F)}var V=m.getGLContext();v=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,v),V.bufferData(V.ARRAY_BUFFER,new Float32Array(g),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null)}},S.Mesh_setNormalsInternal=function(e){if(null!=e&&void 0!=e&&void 0!=e.length&&(g=r(e))){n();var t=(g.length/d,m.getGLContext());v=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,new Float32Array(g),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null)}},S.Mesh_setVertexColorInternal=function(e){var t=[],r=e.length/4;if(r==l){for(var a=0,n=0;n<r;n++)t.push(e[a++]/255),t.push(e[a++]/255),t.push(e[a++]/255),t.push(e[a++]/255);h=t;var i=m.getGLContext();w=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,w),i.bufferData(i.ARRAY_BUFFER,new Float32Array(h),i.STATIC_DRAW),i.bindBuffer(i.ARRAY_BUFFER,null)}},S.getAABB=function(e){if(void 0!=e&&null!=e&&e instanceof SmartVizXFramework.Matrix4||(e=new SmartVizXFramework.Matrix4),s){for(var t=s.length/d,r=new SmartVizXFramework.AABB,a=0;a<t;a++){var n=new SmartVizXFramework.Vector3(s[0*a],s[1*a],s[2*a]);n=e.transformVector(n),r.addPoint(n)}return r}return null}},SmartVizXFramework.Mesh.prototype.destroy=function(){return this.Mesh_destroyInternal()},SmartVizXFramework.Mesh.prototype.setVertices=function(e){return this.Mesh_setVerticesInternal(e)},SmartVizXFramework.Mesh.prototype.setIndices=function(e){return this.Mesh_setIndicesInternal(e)},SmartVizXFramework.Mesh.prototype.prepareRender=function(e){return this.Mesh_prepareRenderInternal(e)},SmartVizXFramework.Mesh.prototype.render=function(e){return this.Mesh_renderInternal(e)},SmartVizXFramework.Mesh.prototype.computeNormals=function(){return this.Mesh_computeNormalsInternal()},SmartVizXFramework.Mesh.prototype.setNormals=function(e){return this.Mesh_setNormalsInternal(e)},SmartVizXFramework.Mesh.prototype.setVertexColor=function(e){return this.Mesh_setVertexColorInternal(e)},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.MeshInstance=function(e){var t=e,r=null,a=this;!function(){e=void 0}(),a.MeshInstance_destroyInternal=function(){t=null},a.MeshInstance_renderInternal=function(e,a,n){null!=r&&(r.begin(e,a,n),t.prepareRender(r),t.render(),r.end())},a.MeshInstance_setMaterialInternal=function(e){r=e},a.MeshInstance_getAABBInternal=function(e){return t?t.getAABB(e):null}},SmartVizXFramework.MeshInstance.prototype.destroy=function(){return this.MeshInstance_destroyInternal()},SmartVizXFramework.MeshInstance.prototype.render=function(e,t,r){return this.MeshInstance_renderInternal(e,t,r)},SmartVizXFramework.MeshInstance.prototype.setMaterial=function(e){return this.MeshInstance_setMaterialInternal(e)},SmartVizXFramework.MeshInstance.prototype.getAABB=function(e){return this.MeshInstance_getAABBInternal(e)},void 0===SmartVizXFramework)var SmartVizXFramework={};if(SmartVizXFramework.BinaryLoader=function(e,t,r,a,n){function i(e){X=new S;var t=new Int32Array(e,0,8);if(X.magicNumber=t[0],X.chunkId=t[1],X.versionNumber=t[2],X.fileSize=t[3],u(),X.fileSize!=e.byteLength)o("Data file "+E+" has been corrupted ");else{var r=new Int32Array(e,F.size,8);if(k=new F,k.chunkId=r[0],k.dataContainsSemantic=r[1],k.chunkId==v.CHUNK_ID_DATA){p=[];for(var a=(S.size+F.size,e.slice(S.size+F.size)),n=!0;a.byteLength>0;){var i=new V;p.push(i);var m=l(a,i);if(!(m>=0)){n=!1,o("Error occured during loading data block...");break}a=a.slice(m)}n&&0==d()&&(n=!1,o("Data file "+E+" has been corrupted "))}else o("Data file "+E+" has been corrupted ")}}function o(e){I(e,E,L)}function l(e,t){var r=new Int32Array(e,0,V.size/4);t.dataBlockSemantic=r[0],t.dataElementType=r[1],t.dataElementSize=r[2],t.dataStride=r[3],t.dataCount=r[4],t.userData[0]=r[5],t.userData[1]=r[6],t.userData[2]=r[7];var a=m(t);if(a>0){var n=V.size,i=V.size+a,o=e.slice(n,i);return 1==t.dataElementSize?t.dataElementType==h.UNSIGNED_INT8?t.data=new Uint8Array(o):t.data=new Int8Array(o):2==t.dataElementSize?t.dataElementType==h.UNSIGNED_INT16?t.data=new Uint16Array(o):t.dataElementType==h.FIXED_2_14||t.dataElementType==h.FIXED_4_12||t.dataElementType==h.FIXED_6_10||t.dataElementType==h.FIXED_8_8||t.dataElementType==h.FIXED_10_6?t.data=new Int16Array(o):t.data=new Int16Array(o):4==t.dataElementSize&&(t.dataElementType==h.FLOAT32?t.data=new Float32Array(o):t.dataElementType==h.INT32?t.data=new Int32Array(o):t.dataElementType==h.UNSIGNED_INT32&&(t.data=new Uint32Array(o))),V.size+t.data.byteLength}return-1}function m(e){return e.dataElementSize*e.dataCount}function u(){for(var e="",t=X.magicNumber,r=0;r<4;r++){var a=255&t;e+=String.fromCharCode(a),t=t-a>>8}}function c(e,t){for(var r=0,a=p.length,n=0;n<a;n++){var i=p[n];if(i.dataBlockSemantic==e){if(!t)return i;if(r>=t)return i;r++}}}function d(){var e=c(w.MESHNAME),t=f(e.data),r=c(w.POSITION),a=c(w.COLOR0),n=c(w.NORMAL),i=c(w.INDICES);c(w.TEXCOORD0),c(w.TEXCOORD1);if(void 0==e)return console.error("Vertex data for "+E+" is not found"),!1;if(void 0==r||void 0==i)return console.error("Vertex data for "+E+" is not found"),!1;var o=new SmartVizXFramework.Mesh(M,t),l=[],m=r.data.length/r.dataStride;if(3!=r.dataStride&&4!=r.dataStride)return console.error("Vertex data stride for "+E+" has to be 3 or 4"),o.destroy(),!1;for(var u=0,d=0;d<m;d++)if(3==r.dataStride){var g=s(r,u++),v=s(r,u++),h=s(r,u++);l.push(new SmartVizXFramework.Vector3(g,v,h));
}else if(4==r.dataStride){var g=s(r,u++),v=s(r,u++),h=s(r,u++),S=s(r,u++);l.push(new SmartVizXFramework.Vector3(g,v,h,S))}if(o.setVertices(l),o.setIndices(i.data),null!=a&&o.setVertexColor(a.data),null!=n){var F=[],V=n.data.length/n.dataStride;if(V==m){if(3!=n.dataStride&&4!=n.dataStride)return console.error("Vertex data stride for "+E+" has to be 3 or 4"),o.destroy(),!1;for(var u=0,d=0;d<V;d++)if(3==n.dataStride){var g=s(n,u++),v=s(n,u++),h=s(n,u++),X=new SmartVizXFramework.Vector3(g,v,h);X.normalize(),F.push(X)}else if(4==n.dataStride){var g=s(n,u++),v=s(n,u++),h=s(n,u++),S=s(n,u++),X=new SmartVizXFramework.Vector3(g,v,h);X.normalize(),F.push(X)}o.setNormals(F)}}return y(o,E,L),z&&(z.destroy(),z=null),!0}function s(e,t){var r=e.data[t];if(e.dataElementType==h.FIXED_2_14){var a=16384;r/=a}else if(e.dataElementType==h.FIXED_4_12){var a=4096;r/=a}else if(e.dataElementType==h.FIXED_6_10){var a=1024;r/=a}else if(e.dataElementType==h.FIXED_8_8){var a=256;r/=a}else if(e.dataElementType==h.FIXED_10_6){var a=64;r/=a}return r}function f(e){for(var t="",r=e.length,a=0;a<r;a++)t+=String.fromCharCode(e[a]);return g(t)}function g(e){var t=e.indexOf("\0");return t>-1?e.substr(0,t):e}var v={CHUNK_ID_HEADER:0,CHUNK_ID_DATA:1},h={CHARACTER:0,NAME:1,FLOAT32:2,INT8:3,UNSIGNED_INT8:4,INT16:5,UNSIGNED_INT16:6,INT32:7,UNSIGNED_INT32:8,FIXED_2_14:9,FIXED_4_12:10,FIXED_6_10:11,FIXED_8_8:12,FIXED_10_6:13},w={None:0,MESHNAME:1,POSITION:2,NORMAL:3,TANGENT:4,BINORMAL:5,TEXCOORD0:6,TEXCOORD1:7,TEXCOORD2:8,TEXCOORD3:9,TEXCOORD4:10,TEXCOORD5:11,TEXCOORD6:12,COLOR0:13,COLOR1:14,COLOR2:15,COLOR3:16,COLOR4:17,COLOR5:18,COLOR6:19,INDICES:20,SKELETONNAME:21,BONES:22,BONEWEIGHTS:23,BONEINFLUENCECOUNTINDICES:24,WEIGHTINDICES:25,BONEINDICES:26,INVBINDMATRIX:27,BINDSHAPEMATRIX:28,REFERENCE:29},S=function(){this.magicNumber=0,this.chunkId=0,this.versionNumber=0,this.fileSize=0};S.size=32;var F=function(){this.chunkId=0,this.dataContainsSemantic=0};F.size=32;var V=function(){this.dataBlockSemantic=0,this.dataElementType=0,this.dataElementSize=0,this.dataStride=0,this.dataCount=0,this.userData=[0,0,0],this.data={}};V.size=32;var X,k,p,z,M=e,E=t,y=r,I=a,L=n,A=this;!function(){e=null,t=null,r=null,a=null,n=null}(),A.loadFile=function(){null!=z&&void 0!=z||(z=new SmartVizXFramework.HttpFileLoader(E,i,o,SmartVizXFramework.HttpFileLoader.FileType.BINARY),z.loadFile())}},void 0===SmartVizXFramework)var SmartVizXFramework={};SmartVizXFramework.Application=function(e){function t(){A=new SmartVizXFramework.Matrix4,R=-1,C=-1,D=new SmartVizXFramework.Matrix4,O=0,U=45,B=O,Y=U,Z=0,q=0,P=void 0,W=void 0,G=0,H=0,w(),_=D.getInverse(),V(),T=new SmartVizXFramework.InputHandler,T.addOnEvent("onMoveForward",r),T.addOnEvent("onMoveBackward",a),T.addOnEvent("onMoveLeft",n),T.addOnEvent("onMoveRight",i),T.addOnEvent("onLookUp",m),T.addOnEvent("onLookDown",u),T.addOnEvent("onLookLeft",c),T.addOnEvent("onLookRight",d),T.addOnEvent("onMoveUp",o),T.addOnEvent("onMoveDown",l),T.addOnEvent("onDeviceOrientation",f),T.addOnEvent("onAccelerometer",h),S(0)}function r(e){var t=D.getForward();t.multiplyScaler(-E)}function a(e){var t=D.getForward();t.multiplyScaler(E),D.translate(t)}function n(e){var t=D.getRight();t.multiplyScaler(-E),D.translate(t)}function i(e){var t=D.getRight();t.multiplyScaler(E),D.translate(t)}function o(e){var t=new SmartVizXFramework.Vector3(0,1,0);t.multiplyScaler(E),D.translate(t)}function l(e){var t=new SmartVizXFramework.Vector3(0,1,0);t.multiplyScaler(-E),D.translate(t)}function m(e){if(re){ie+=y,ie>=360&&(ie=360-ie);var t={Angles:{alpha:ne,beta:ie,gamma:0},Orientation:0};f(t)}}function u(e){if(re){ie-=y,ie<0&&(ie=360+ie);var t={Angles:{alpha:ne,beta:ie,gamma:0},Orientation:0};f(t)}}function c(e){re&&s(-y)}function d(e){re&&s(y)}function s(e){ne+=e,ne>=360&&(ne=360-ne),ne<0&&(ne=360+ne);var t={Angles:{alpha:ne,beta:ie,gamma:0},Orientation:0};f(t)}function f(e){if(e&&e.Angles){var t=e.Angles.alpha,r=e.Angles.beta,a=e.Angles.gamma;90==e.Orientation?(t=e.Angles.alpha,r=-e.Angles.gamma):e.Orientation==-90&&(t=e.Angles.alpha,r=e.Angles.gamma),void 0==P&&(P=t),void 0==W&&(W=r),void 0==oe&&(oe=new SmartVizXFramework.Matrix4,oe.fromEuler(new SmartVizXFramework.Vector3(t*SmartVizXFramework.Math.DegToRad,r*SmartVizXFramework.Math.DegToRad,a*SmartVizXFramework.Math.DegToRad),"XYZ"));var n=new SmartVizXFramework.Matrix4;n.fromEuler(new SmartVizXFramework.Vector3(t*SmartVizXFramework.Math.DegToRad,r*SmartVizXFramework.Math.DegToRad,a*SmartVizXFramework.Math.DegToRad),"XYZ");var i=oe.getUp(),o=n.getUp(),l=oe.getRight(),m=i.getCross(o);i.normalize(),o.normalize();var u=i.dot(o);u=SmartVizXFramework.Math.Clamp(u,-1,1);var c=Math.acos(u)*SmartVizXFramework.Math.RadToDeg;m.dot(l)<0&&(c=360-c),Z=c,q=r;var d=v();G+=.15*g(360+d.pitchDiff,G),H+=.15*g(360+d.yawDiff,H),B=O+H,Y=U+G,w()}}function g(e,t,r){var a=new SmartVizXFramework.Matrix4;a.setRotationY(SmartVizXFramework.Math.DegToRad*e);var n=a.getForward();n.normalize(),a.setRotationY(SmartVizXFramework.Math.DegToRad*t);var i=a.getForward();i.normalize();var o=n.dot(i);o=SmartVizXFramework.Math.Clamp(o,-1,1);var l=Math.acos(o)*SmartVizXFramework.Math.RadToDeg;r&&l>r&&(l=r);var m=n.getCross(i);return m.dot(le)<0?-l:l}function v(){return void 0!=P&&void 0!=W?{yawDiff:g(P,Z,M),pitchDiff:g(W,q,z)}:{yawDiff:0,pitchDiff:0}}function h(e){}function w(){if(re){var e=(new SmartVizXFramework.Vector3(0,0,1),new SmartVizXFramework.Matrix4);e.angleAxis(SmartVizXFramework.Math.DegToRad*B,new SmartVizXFramework.Vector3(0,1,0));var t=e.getRight(),r=new SmartVizXFramework.Matrix4;r.angleAxis(SmartVizXFramework.Math.DegToRad*Y,t),r.postMultiply(e),D.copy(r);var a=D.getForward();a.multiplyScaler(Q),r.angleAxis(5*SmartVizXFramework.Math.DegToRad,t),D.preMultiply(r),D.setTranslate(a)}}function S(e){var t=L.getGLContext(),r=e-b,a=1/30;if(r=.001*r,r>=a&&(r=a),F(r),T.update(r),b=e,_=D.getInverse(),SmartVizXFramework.Material.lightDir1.copy(j),SmartVizXFramework.Material.lightDir2.copy(K),SmartVizXFramework.Material.directionalLight1Intensity=J,SmartVizXFramework.Material.directionalLight2Intensity=$,SmartVizXFramework.Material.ambientLightColor=ee,R!=I.clientWidth||C!=I.clientHeight){var n=I.clientWidth/I.clientHeight;if(SmartVizXFramework.Settings.requiredAspect!=n){var i=I.clientWidth*SmartVizXFramework.Settings.requiredAspect;I.style.height=""+i+"px"}A.constructProjectionMatrix(60*Math.PI/180,I.clientWidth/I.clientHeight,te,50),L.resize(I.clientWidth,I.clientHeight),R=I.clientWidth,C=I.clientHeight}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearColor(1,1,1,1),t.clearDepth(1),t.viewport(0,0,L.getWidth(),L.getHeight()),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);for(var o in N)N[o].instance.render(A,_,N[o].transform);window.requestAnimationFrame(S)}function F(e){function t(){if(he==g+1){he=0,a=!1,se=0;for(var e=de.length,t=0;t<e;t++){var r=de[t];r.moving=!1,r.movingIn=!1}}}if(N){if(N.green&&N.green.transform.setTranslate(ce.green),N.red&&N.red.transform.setTranslate(ce.red),N.purple&&N.purple.transform.setTranslate(ce.purple),N.green&&N.red&&N.purple){var r=de.length,a=!0;if(r>0){for(var n=0;n<r;n++){var i=de[n];if(!i.moving&&se>=i.startTime){i.moving=!0,i.currMovingT=0,se=0;break}}for(var n=0;n<r;n++){var i=de[n];if(i.moving){var o,l=ce[i.node],m=(ue[i.node],N[i.node]);i.movingIn?o=new SmartVizXFramework.Vector3(0,0,0):(o=ue[i.node].getCopy(),o.multiplyScaler(me));var u=o.getCopy();u.subtract(l),i.currMovingT=i.currMovingT+2*(fe-i.currMovingT)*e,u.multiplyScaler(i.currMovingT*e),l.add(u),m.transform.setTranslate(l);var c=.001;o.subtract(l);var d=o.magnitude();d>c?a=!1:i.movingIn||(i.movingIn=!0)}}}var s=30,g=2;if(he==g&&(s=0),a&&(void 0==window.orientation||null==window.orientation)){var v=1,h=.5,w=1;if(ge){var S=s;ve+=(h-ve)*e*w,ne+=(S-ne)*e*ve,Math.abs(S-ne)<v&&(ge=!1,ve=0,he++,t())}else{var S=-s;ve+=(h-ve)*e*w,ne+=(S-ne)*e*ve,Math.abs(S-ne)<v&&(ge=!0,ve=0,he++,t())}var F={Angles:{alpha:ne,beta:ie,gamma:0},Orientation:0};f(F)}}se+=e}}function V(){var e=["themes/demo/assets/media/green.sgb","themes/demo/assets/media/purple.sgb","themes/demo/assets/media/red.sgb"];p(e,function(){X()})}function X(){N.green=k(x.green,[1,0,0,1],new SmartVizXFramework.Vector3(0,0,0)),N.purple=k(x.purple,[1,0,0,1],new SmartVizXFramework.Vector3(0,0,0)),N.red=k(x.red,[1,0,0,1],new SmartVizXFramework.Vector3(0,0,0)),re=N.green.instance.getAABB(),re.union(N.purple.instance.getAABB()),re.union(N.red.instance.getAABB()),s(0)}function k(e,t,r,a,n){var i=new SmartVizXFramework.MeshInstance(e),o=new SmartVizXFramework.Material(L);o.setMainColor(t[0],t[1],t[2],t[3]),i.setMaterial(o);var l=new SmartVizXFramework.Matrix4;return a&&SmartVizXFramework.Utils.isValidNum(a)&&n&&n instanceof SmartVizXFramework.Vector3&&(n.normalize(),l.angleAxis(a*SmartVizXFramework.Math.DegToRad,n)),r&&r instanceof SmartVizXFramework.Vector3&&l.setTranslate(r),{instance:i,material:o,transform:l}}function p(e,t){function r(o,l,m){if(x[SmartVizXFramework.Utils.getFileNameFromPathWithoutExtension(l)]=o,i++,i>=n)t();else{var u=new SmartVizXFramework.BinaryLoader(L,e[i],r,a);u.loadFile()}}function a(o,l,m){if(x[SmartVizXFramework.Utils.getFileNameFromPathWithoutExtension(l)]=null,i++,i>=n)t();else{var u=new SmartVizXFramework.BinaryLoader(L,e[i],r,a);u.loadFile()}}var n=e.length,i=0,o=new SmartVizXFramework.BinaryLoader(L,e[i],r,a);o.loadFile()}var z=30,M=360,E=.01,y=.5,I=e,L=null,A=null,R=0,C=0,D=null,_=null,T=null,x={},N={},b=0,O=0,U=0,B=0,Y=0,G=0,H=0,P=void 0,W=void 0,Z=0,q=0,Q=1.15,j=new SmartVizXFramework.Vector3(.1875174,(-.7660438),(-.6148285)),K=new SmartVizXFramework.Vector3((-2),.5,(-1)),J=1.2,$=0,ee=[.15,.15,.15,1],te=.01,re=null,ae=this;!function(){j.normalize(),K.normalize(),L=new SmartVizXFramework.WebGLContext(I),t(),e=void 0,I.onunload=function(){ae.destroy(),I.onunload=void 0}}();var ne=0,ie=0,oe=void 0,le=new SmartVizXFramework.Vector3(0,1,0),me=3,ue={green:new SmartVizXFramework.Vector3((-.4772438),0,(-.8787709)),red:new SmartVizXFramework.Vector3((-.4772438),0,(-.8787709)),purple:new SmartVizXFramework.Vector3(.4772438,0,.8787709)},ce={green:ue.green.getMultiplyScaler(me),red:ue.red.getMultiplyScaler(me),purple:ue.purple.getMultiplyScaler(me)},de=[{node:"green",startTime:0,moving:!1,currMovingT:0,movingIn:!0},{node:"purple",startTime:.5,moving:!1,currMovingT:0,movingIn:!0},{node:"red",startTime:.5,moving:!1,currMovingT:0,movingIn:!0}],se=0,fe=6,ge=!0,ve=0,he=0;ae.destroy=function(){T.removeOnEvent(r),T.removeOnEvent(a),T.removeOnEvent(n),T.removeOnEvent(i),T.removeOnEvent(m),T.removeOnEvent(u),T.removeOnEvent(c),T.removeOnEvent(d),T.removeOnEvent(f),T.removeOnEvent(h),T.destroy(),T=null;L.destroy(),A=null,D=null,_=null;for(var e in N)N[e].material.destroy(),N[e].instance.destroy();for(var e in x)x[e].destroy();x={},N={},ae=null}};